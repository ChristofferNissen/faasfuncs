arch: arm64
os: linux
dist: xenial
language: python
services:
  - docker

before_install: 
  # check archicture. .com does not support arm atm.
  - dpkg --print-architecture
  
  # installing newer docker
  - sudo apt-get update
  
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
  
  # installing the faas-cli
  - curl -sSL https://cli.openfaas.com | sudo sh
  
script:
  # Build
  - faas-cli build -f cstest.yml
  
  # Test
  # testing tbc later..

  # Deploy
  - echo $OPENFAAS_PASS | faas-cli login --username admin --password-stdin -g https://gateway.christoffernissen.me
  - faas-cli push -f cstest.yml
  - faas-cli deploy -f cstest.yml
